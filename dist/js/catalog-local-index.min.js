function setCookie(e,t,o={}){(o={path:"/",...o}).expires instanceof Date&&(o.expires=o.expires.toUTCString());let n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(let e in o){n+="; "+e;let t=o[e];!0!==t&&(n+="="+t)}document.cookie=n}function getCookie(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function deleteCookie(e){setCookie(e,"",{"max-age":-1})}function changeCookie(e,t,o){changeQuantity(e.closest(t).href.split("id=")[1],o),changeQuantity("totalQuantity",o)}function changeQuantity(e,t){null==getCookie(e)?setCookie(e,t,{sameSite:"Strict",expires:"Tue, 19 Jan 2038 03: 14: 07 GMT"}):(setCookie(e,+getCookie(e)+t,{sameSite:"Strict",expires:"Tue, 19 Jan 2038 03: 14: 07 GMT"}),0==getCookie(e)&&deleteCookie(e))}function fixString(e,t,o){if(-1!=e.indexOf(t)){let n=0,r="";for(;e.split(t)[n];)r+=e.split(t)[n],n++,e.split(t)[n]&&(r+=o);e=r}return e}document.addEventListener("DOMContentLoaded",(e=>{"dark"==getCookie("theme")&&(document.querySelector("body").classList.add("dark-theme"),document.querySelector(".theme-changer__button").classList.add("_active"))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("body");header=document.querySelector(".header"),headerBurger=document.querySelector(".search-header__burger"),headerDropdownMenu=document.querySelector(".search-header__dropdown"),headerSearch=document.querySelector(".search-header"),headerSearchLowres=document.querySelector(".search-header__button_lowres"),headerSearchForm=document.querySelector(".search-header__item"),headerSearchInput=document.querySelector(".search-header__input"),themeChangerButton=document.querySelector(".theme-changer__button"),headerCart=document.querySelector(".search-header__button_buy");new IntersectionObserver((function(e,t){e[0].isIntersecting?header.classList.remove("_scroll"):header.classList.add("_scroll")})).observe(header);const t=document.querySelector(".announcement-header__close-button");"hidden"==getCookie("announcement")&&(t.parentNode.style.transition="none",t.parentNode.classList.add("_hidden"),header.classList.add("_no-announcement")),t.addEventListener("click",(()=>{t.parentNode.classList.add("_hidden"),header.classList.add("_no-announcement");let e=new Date;e.setHours(e.getHours()+1),e=e.toUTCString(),setCookie("announcement","hidden",{sameSite:"Strict",expires:e})}));let o=document.querySelector(".search-header__counter");function n(e){e.classList.remove("_hover"),e.lastElementChild.classList.contains("dropdown-menu__sublist")&&Array.from(e.lastElementChild.children).forEach((e=>{e.classList.contains("_hover")&&(n(e),e.classList.remove("_hover"))}))}null!=getCookie("totalQuantity")&&(o.innerHTML=getCookie("totalQuantity")),"0"!=o.innerHTML&&o.classList.add("_active"),headerBurger.addEventListener("click",(t=>{Array.from(headerDropdownMenu.querySelector(".dropdown-menu__list").children).forEach((e=>{e.classList.contains("_hover")&&n(e)})),headerBurger.classList.toggle("_active"),document.documentElement.clientWidth<=720&&e.classList.add("_no-scroll")})),document.addEventListener("click",(t=>{const o=t.target;(!o.closest(".search-header__burger")&&!o.closest(".search-header__dropdown")||o.closest(".dropdown-menu__free-space-cover")||o.closest(".dropdown-menu__close-button"))&&headerBurger.classList.contains("_active")&&(Array.from(headerDropdownMenu.querySelector(".dropdown-menu__list").children).forEach((e=>{e.classList.contains("_hover")&&n(e)})),headerBurger.classList.remove("_active"),document.documentElement.clientWidth<=720&&e.classList.remove("_no-scroll"))})),window.addEventListener("resize",(t=>{document.documentElement.clientWidth>720&&e.classList.contains("_no-scroll")&&e.classList.remove("_no-scroll")})),headerDropdownMenu.addEventListener("mouseover",(e=>{if(document.documentElement.clientWidth>720){const t=e.target;let o;t.closest(".dropdown-menu__item")&&(t.closest(".dropdown-menu__item").classList.add("_hover"),o=Array.from(t.closest(".dropdown-menu__item").parentNode.children),o.forEach((e=>{t.closest(".dropdown-menu__item")!=e&&e.classList.contains("_hover")&&n(e)})))}})),window.addEventListener("resize",(e=>{if(document.documentElement.clientWidth<721){let e=headerDropdownMenu.querySelector("._hover");e&&e.classList.remove("_hover")}})),header.addEventListener("click",(e=>{const t=e.target;if(t.closest(".dropdown-menu__expand-button")){const e=t.closest(".dropdown-menu__item").querySelector(".dropdown-menu__sublist"),o=t.closest(".dropdown-menu__expand-button");$(e).slideToggle(),o.classList.toggle("_active")}})),window.addEventListener("resize",(e=>{document.documentElement.clientWidth>720&&(sublistArr=Array.from(document.querySelectorAll(".dropdown-menu__sublist")),sublistArr.forEach((e=>{"none"==getComputedStyle(e).display&&(e.style.display="block")})))})),headerSearch.addEventListener("click",(e=>{const t=e.target;document.documentElement.clientWidth<720&&(t.closest(".search-header__button_lowres")||t.closest(".search-header__icon_close"))&&(headerSearchLowres.classList.toggle("_active"),headerSearchForm.classList.toggle("_active"))})),document.addEventListener("click",(e=>{const t=e.target;document.documentElement.clientWidth<720&&!t.closest(".search-header__item")&&!t.closest(".search-header__button_lowres")&&headerSearchForm.classList.contains("_active")&&(headerSearchLowres.classList.remove("_active"),headerSearchForm.classList.remove("_active"))})),themeChangerButton.addEventListener("click",(t=>{e.classList.contains("dark-theme")?setCookie("theme","bright",{sameSite:"Strict",expires:"Tue, 19 Jan 2038 03: 14: 07 GMT"}):setCookie("theme","dark",{sameSite:"Strict",expires:"Tue, 19 Jan 2038 03: 14: 07 GMT"}),themeChangerButton.classList.toggle("_active"),e.classList.toggle("dark-theme")}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=new URL(location.href).searchParams.get("cat"),t=document.querySelector(".catalog__items"),o=document.querySelector("title"),n=document.querySelector(".items-catalog__nothing-found");cartCounter=document.querySelector(".search-header__counter"),loadButton=document.querySelector(".catalog__load-more-button"),filters=document.querySelector(".sidebar__filters");let r=[],c=[],s=0,a=0,i=0,l={};function d(e){searchResultCover=document.querySelector(".items-catalog__cover"),s+20<e.length?(productsToLoadCount=20,loadButton.classList.remove("_blocked")):(productsToLoadCount=e.length-s,loadButton.classList.add("_blocked"));for(let o=s;o<s+productsToLoadCount;o++){let n=e[o];const r=n.col4,c=n.col6;let s=n.col1,a=n.col2,i=`\n                <a href="product?id=${fixString(s," ","_")+"__"+fixString(a," ","_")}" class="items-catalog__row product">\n                    <div class="product__block product__block_brand">\n                        <span class="product__text product__text_brand">${s} ${a}</span>\n                    </div>\n                    <div class="product__block product__block_description">\n                        <span class="product__text product__text_description">${r}</span>\n                    </div>\n                    <div class="product__block product__block_price">\n                        <span class="product__text product__text_price">${c}₽</span>\n                    </div>\n                    <button class="product__button product__button_buy button" type="button">\n                        <span class="product__button-text button__text">В корзину</span>\n                    </button>\n                </a>\n                `;t.insertAdjacentHTML("beforeend",i)}s+=productsToLoadCount,searchResultCover.classList.add("_hidden")}function u(){var e;c=[],r.forEach((e=>{let t=0,o=0;l.brands&&l.brands.length>0?l.brands.forEach((o=>{o==e.col1&&(t=1)})):t=1,1==a?e.col8>0&&(o=1):o=1,1==t&&1==o&&c.push(e)})),1==i?c.sort(_):-1==i&&c.sort(h),e=c,Array.from(t.querySelectorAll(".items-catalog__row")).forEach((e=>{e.remove()})),s=0,d(e),0==e.length?n.classList.add("_active"):n.classList.remove("_active")}function _(e,t){let o,n;return o=e.col6.split(",")[1]?e.col6.split(",")[0]+e.col6.split(",")[1]:e.col6,n=t.col6.split(",")[1]?t.col6.split(",")[0]+t.col6.split(",")[1]:t.col6,+o>+n?1:+o==+n?0:+o<+n?-1:void 0}function h(e,t){let o,n;return o=e.col6.split(",")[1]?e.col6.split(",")[0]+e.col6.split(",")[1]:e.col6,n=t.col6.split(",")[1]?t.col6.split(",")[0]+t.col6.split(",")[1]:t.col6,+o<+n?1:+o==+n?0:+o>+n?-1:void 0}!function(){let t;const n=document.querySelector(".catalog__title");switch(e){case"oil":t="Масла и жидкости";break;case"lamps":t="Лампы";break;case"filters":t="Фильтры"}n.insertAdjacentText("beforeend",t),o.insertAdjacentText("beforeend",`${t} | Француз-Авто`)}(),Array.from(document.querySelectorAll("input[type=radio]")).forEach((e=>{e.checked=!1})),async function(){let t=await fetch("json/data.json",{method:"GET"});if(t.ok){!function(t){let o;switch(e){case"oil":o="МАСЛА и жидкости";break;case"lamps":o="лампа";break;case"filters":o="фильтры"}r=t.filter((e=>e.col9==o)),function(e){let t=[e[0].col1];const o=document.querySelector("#brands-filter");e.forEach((e=>{let o=0;t.forEach((t=>{t==e.col1&&(o=1)})),0==o&&t.push(e.col1)})),t.forEach((e=>{o.insertAdjacentHTML("beforeend",`\n                <div class="options-filter__item">\n                    <input id="${e}" class="options-filter__checkbox" type="checkbox" name="${e}" value="${e}" />\n                    <label class="options-filter__label" for="${e}"> ${e} </label>\n                </div>\n            `)}))}(r),d(r)}(await t.json())}else alert("something went wrong...")}(),loadButton.addEventListener("click",(()=>{c.length>0&&s<c.length?d(c):s<r.length&&d(r)})),filters.addEventListener("change",(e=>{const t=e.target;t.classList.contains("options-filter__checkbox")&&"brands-filter"==t.parentNode.parentNode.id&&function(){const e=document.querySelector("#brands-filter");let t=[];Array.from(e.children).forEach((e=>{1==e.firstElementChild.checked&&t.push(e.firstElementChild.name)})),l.brands=t,u()}(),t.classList.contains("options-filter__radio")&&("price-decrease"==t.id&&(i=-1,u()),"price-increase"==t.id&&(i=1,u()),"availability-in-stock"==t.id&&(a=1,u()),"availability-for-order"==t.id&&(a=0,u()))})),filters.addEventListener("click",(e=>{const t=e.target;if(t.closest(".filter__dropdown-button")){const e=t.closest(".filter");e.classList.toggle("_hidden"),$(e).children(".filter__body").slideToggle()}})),filters.addEventListener("input",(e=>{const t=e.target;if(t.classList.contains("search-filter__input")){const e=Array.from(t.parentNode.nextElementSibling.children);""!=t.value?e.forEach((e=>{e.firstElementChild.name.includes(t.value.toUpperCase())?e.classList.remove("_hidden"):e.classList.add("_hidden")})):e.forEach((e=>{e.classList.remove("_hidden")}))}})),t.addEventListener("click",(e=>{const t=e.target;t.closest(".product__button_buy")&&(e.preventDefault(),t.closest(".product__button_buy").classList.add("onclick"),setTimeout((()=>{t.closest(".product__button_buy").classList.remove("onclick")}),200),changeCookie(t,".items-catalog__row",1),document.querySelector(".search-header__counter").innerHTML=+cartCounter.innerHTML+1,"0"!=cartCounter.innerHTML&&cartCounter.classList.add("_active"))}))})),document.addEventListener("DOMContentLoaded",(()=>{$(".title-footer").click((function(){document.documentElement.clientWidth<=560&&($(this).next().slideToggle(),$(this).next().hasClass("contacts-footer__wrapper")&&$(this).next().css("display","flex"),$(this).toggleClass("_active"))})),$(window).resize((function(){document.documentElement.clientWidth>560&&($(".title-footer").next().css("display","block"),$(".title-footer").next().hasClass("contacts-footer__wrapper")&&$(".contacts-footer__wrapper").css("display","flex"),$(".title-footer").hasClass("_active")&&$(".title-footer").removeClass("_active")),document.documentElement.clientWidth<=560&&($(".title-footer").hasClass("_active")||$(".title-footer").next().css("display","none"))}))}));